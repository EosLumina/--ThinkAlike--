<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://eoslumina.github.io/--ThinkAlike--/guides/developer_guides/ml_development_guidelines/" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>ML Development Guidelines - ThinkAlike Documentation</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "ML Development Guidelines";
        var mkdocs_page_input_path = "guides/developer_guides/ml_development_guidelines.md";
        var mkdocs_page_url = "/--ThinkAlike--/guides/developer_guides/ml_development_guidelines/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> ThinkAlike Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="" href="../../../index.md">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Core</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../core/enlightenment_2_0/enlightenment_2_0_principles/">Enlightenment 2.0 Principles</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../core/ethics/ethical_guidelines/">Ethical Guidelines</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../core/contributing/">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../core/installation/">Installation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../core/onboarding_guide/">Onboarding Guide</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Vision</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../vision/core_concepts/">Core Concepts Explained</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../vision/blockchain_integration/">Blockchain Integration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Architecture</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../architecture/architectural_overview/">Architectural Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../architecture/api/api_endpoints_mode2/">API Endpoints (Mode 2)</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Development</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../code_style_guide/">Code Style Guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../building_backend_endpoint/">Building Backend Endpoint Guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../building_ui_component/">Building UI Component Guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ui_validation_examples/">UI Validation Examples</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../git_workflow/">Git Workflow Standard</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../development/github_actions_workflow_format.md">GitHub Actions Workflow Format</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DevOps</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="../../devops/devops_workflow.md">DevOps Workflow Guide</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../devops/ci_cd_workflow_reference.md">CI/CD Workflow Reference</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">ThinkAlike Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">ML Development Guidelines</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="ml-development-guidelines">ML Development Guidelines</h1>
<hr />
<h2 id="1-introduction">1. Introduction</h2>
<p>This document outlines the best practices and standards for machine learning development at ThinkAlike. As ML is central to our recommendation and matching systems, following these guidelines ensures our models are accurate, fair, explainable, and maintainable. These standards apply to all ML components across the platform.</p>
<hr />
<h2 id="2-ml-development-lifecycle">2. ML Development Lifecycle</h2>
<h3 id="21-overview">2.1 Overview</h3>
<p>ThinkAlike follows a structured ML development lifecycle:</p>
<div class="highlight"><pre><span></span><code>Problem Definition → Data Collection → Exploratory Analysis →
Feature Engineering → Model Development → Evaluation →
Deployment → Monitoring → Iteration
</code></pre></div>
<h3 id="22-documentation-requirements">2.2 Documentation Requirements</h3>
<p>Document the following for each ML initiative:</p>
<ul>
<li>
<p><strong>Business objective</strong>: What problem are we solving?</p>
</li>
<li>
<p><strong>Success metrics</strong>: How will we measure success?</p>
</li>
<li>
<p><strong>Data sources</strong>: What data will be used?</p>
</li>
<li>
<p><strong>Feature dictionary</strong>: Description of all features</p>
</li>
<li>
<p><strong>Model architecture</strong>: Type and structure of the model</p>
</li>
<li>
<p><strong>Training methodology</strong>: How the model was trained</p>
</li>
<li>
<p><strong>Evaluation results</strong>: Performance metrics and analysis</p>
</li>
<li>
<p><strong>Limitations</strong>: Known limitations and constraints</p>
</li>
<li>
<p><strong>Ethical considerations</strong>: Bias and fairness assessment</p>
</li>
</ul>
<hr />
<h2 id="3-data-management">3. Data Management</h2>
<h3 id="31-data-collection">3.1 Data Collection</h3>
<ul>
<li>
<p><strong>Consent</strong>: Ensure data is collected with appropriate consent</p>
</li>
<li>
<p><strong>Documentation</strong>: Document all data sources and collection methods</p>
</li>
<li>
<p><strong>Privacy</strong>: Adhere to privacy regulations and company policies</p>
</li>
<li>
<p><strong>Quality</strong>: Implement data quality checks at collection points</p>
</li>
</ul>
<h3 id="32-data-preparation">3.2 Data Preparation</h3>
<ul>
<li>
<p><strong>Versioning</strong>: Version all datasets used for training and testing</p>
</li>
<li>
<p><strong>Pipeline</strong>: Create reproducible data preparation pipelines</p>
</li>
<li>
<p><strong>Splitting</strong>: Use consistent methods for train/validation/test splits</p>
</li>
<li>
<p><strong>Labeling</strong>: Document labeling procedures and quality metrics</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># Example data splitting with proper seeding</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>

<span class="k">def</span><span class="w"> </span><span class="nf">split_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">val_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Split dataset into train, validation, and test sets.&quot;&quot;&quot;</span>
    <span class="c1"># First split off test set</span>

    <span class="n">X_train_val</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train_val</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">test_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span>
    <span class="p">)</span>

    <span class="c1"># Then split training into train and validation</span>

    <span class="c1"># Adjust validation size to account for the test split</span>

    <span class="n">relative_val_size</span> <span class="o">=</span> <span class="n">val_size</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">test_size</span><span class="p">)</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
        <span class="n">X_train_val</span><span class="p">,</span> <span class="n">y_train_val</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">relative_val_size</span><span class="p">,</span>
        <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y_train_val</span>
    <span class="p">)</span>

    <span class="c1"># Log split sizes</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Train set: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Validation set: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test set: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">),</span> <span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</code></pre></div>
<h3 id="33-feature-engineering">3.3 Feature Engineering</h3>
<ul>
<li>
<p><strong>Documentation</strong>: Document all feature transformations</p>
</li>
<li>
<p><strong>Code</strong>: Encapsulate feature engineering in reusable components</p>
</li>
<li>
<p><strong>Testing</strong>: Test feature engineering code with unit tests</p>
</li>
<li>
<p><strong>Versioning</strong>: Version feature engineering code alongside models</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># Example feature engineering class with proper documentation</span>

<span class="k">class</span><span class="w"> </span><span class="nc">UserFeatureTransformer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Transforms raw user data into features for recommendation models.</span>

<span class="sd">    This transformer handles:</span>

<span class="sd">    * Missing value imputation</span>

<span class="sd">    * Categorical encoding</span>

<span class="sd">    * Feature normalization</span>

<span class="sd">    * Feature interaction creation</span>

<span class="sd">    Attributes:</span>
<span class="sd">        categorical_features (list): List of categorical feature names</span>
<span class="sd">        numerical_features (list): List of numerical feature names</span>
<span class="sd">        encoders (dict): Dictionary mapping feature names to fitted encoders</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">categorical_features</span><span class="p">,</span> <span class="n">numerical_features</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">categorical_features</span> <span class="o">=</span> <span class="n">categorical_features</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numerical_features</span> <span class="o">=</span> <span class="n">numerical_features</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoders</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit encoders on training data.</span>

<span class="sd">        Args:</span>
<span class="sd">            X (pd.DataFrame): Training data</span>

<span class="sd">        Returns:</span>
<span class="sd">            self: Returns the fitted transformer</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Implementation details...</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Transform data using fitted encoders.</span>

<span class="sd">        Args:</span>
<span class="sd">            X (pd.DataFrame): Data to transform</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: Transformed features</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Implementation details...</span>

        <span class="k">return</span> <span class="n">transformed_features</span>
</code></pre></div>
<hr />
<h2 id="4-model-development">4. Model Development</h2>
<h3 id="41-model-selection">4.1 Model Selection</h3>
<p>Consider the following when selecting a model type:</p>
<ul>
<li>
<p><strong>Interpretability requirements</strong></p>
</li>
<li>
<p><strong>Data characteristics</strong></p>
</li>
<li>
<p><strong>Performance requirements</strong></p>
</li>
<li>
<p><strong>Inference time constraints</strong></p>
</li>
<li>
<p><strong>Maintainability</strong></p>
</li>
</ul>
<p>Document the rationale for model selection.</p>
<h3 id="42-training-practices">4.2 Training Practices</h3>
<ul>
<li>
<p><strong>Reproducibility</strong>: Set and document random seeds</p>
</li>
<li>
<p><strong>Hyperparameter tuning</strong>: Use systematic approaches (grid search, Bayesian optimization)</p>
</li>
<li>
<p><strong>Training history</strong>: Log training metrics and hyperparameters</p>
</li>
<li>
<p><strong>Resource utilization</strong>: Monitor and optimize computational resource usage</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># Example hyperparameter tuning with logging</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlflow</span><span class="w"> </span><span class="kn">import</span> <span class="n">log_params</span><span class="p">,</span> <span class="n">log_metrics</span>

<span class="k">def</span><span class="w"> </span><span class="nf">tune_model</span><span class="p">(</span><span class="n">model_class</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Tune model hyperparameters and log results.</span>

<span class="sd">    Args:</span>
<span class="sd">        model_class: Sklearn-compatible model class</span>
<span class="sd">        param_grid: Dictionary of hyperparameters to search</span>
<span class="sd">        X_train/y_train: Training data</span>
<span class="sd">        X_val/y_val: Validation data</span>

<span class="sd">    Returns:</span>
<span class="sd">        best_model: Tuned model instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create search</span>

    <span class="n">search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span>
        <span class="n">model_class</span><span class="p">(),</span>
        <span class="n">param_grid</span><span class="p">,</span>
        <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;f1_weighted&#39;</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span>
    <span class="p">)</span>

    <span class="c1"># Fit search</span>

    <span class="n">search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="c1"># Log hyperparameter search results</span>

    <span class="n">log_params</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
    <span class="n">log_metrics</span><span class="p">({</span>
        <span class="s1">&#39;train_f1&#39;</span><span class="p">:</span> <span class="n">search</span><span class="o">.</span><span class="n">best_score_</span><span class="p">,</span>
        <span class="s1">&#39;val_f1&#39;</span><span class="p">:</span> <span class="n">search</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>
    <span class="p">})</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best parameters: </span><span class="si">{</span><span class="n">search</span><span class="o">.</span><span class="n">best_params_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best training F1: </span><span class="si">{</span><span class="n">search</span><span class="o">.</span><span class="n">best_score_</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Validation F1: </span><span class="si">{</span><span class="n">search</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_val</span><span class="p">,</span><span class="w"> </span><span class="n">y_val</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">search</span><span class="o">.</span><span class="n">best_estimator_</span>
</code></pre></div>
<h3 id="43-model-architecture-documentation">4.3 Model Architecture Documentation</h3>
<p>Document the following for each model:</p>
<ul>
<li>
<p><strong>Architecture diagram</strong> (for neural networks)</p>
</li>
<li>
<p><strong>Layer descriptions</strong></p>
</li>
<li>
<p><strong>Input and output specifications</strong></p>
</li>
<li>
<p><strong>Dependencies and environment</strong></p>
</li>
</ul>
<hr />
<h2 id="5-evaluation-and-validation">5. Evaluation and Validation</h2>
<h3 id="51-evaluation-metrics">5.1 Evaluation Metrics</h3>
<p>Select appropriate metrics for your problem type:</p>
<ul>
<li>
<p><strong>Classification</strong>: Accuracy, precision, recall, F1, AUC-ROC</p>
</li>
<li>
<p><strong>Regression</strong>: MSE, MAE, RMSE, R-squared</p>
</li>
<li>
<p><strong>Ranking</strong>: NDCG, MAP, MRR</p>
</li>
<li>
<p><strong>Recommendation</strong>: Precision@K, Recall@K, MAP@K</p>
</li>
</ul>
<p>Always document why specific metrics were chosen.</p>
<h3 id="52-validation-strategies">5.2 Validation Strategies</h3>
<p>Use appropriate validation strategies:</p>
<ul>
<li>
<p><strong>Simple holdout</strong>: For large datasets with balanced distributions</p>
</li>
<li>
<p><strong>K-fold cross-validation</strong>: For smaller datasets</p>
</li>
<li>
<p><strong>Stratified sampling</strong>: For imbalanced datasets</p>
</li>
<li>
<p><strong>Time-based splits</strong>: For time-series data</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># Example time-based validation for recommendation models</span>

<span class="k">def</span><span class="w"> </span><span class="nf">time_based_validation</span><span class="p">(</span><span class="n">user_item_interactions</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create time-based train/validation splits.</span>

<span class="sd">    Args:</span>
<span class="sd">        user_item_interactions: DataFrame with user_id, item_id, timestamp</span>
<span class="sd">        n_splits: Number of validation folds to create</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: List of (train_indices, val_indices) tuples</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Sort interactions by timestamp</span>

    <span class="n">sorted_data</span> <span class="o">=</span> <span class="n">user_item_interactions</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;timestamp&#39;</span><span class="p">)</span>

    <span class="c1"># Calculate split points</span>

    <span class="n">split_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorted_data</span><span class="p">)</span> <span class="o">//</span> <span class="p">(</span><span class="n">n_splits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">split_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">split_size</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_splits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>

    <span class="c1"># Create train/validation splits</span>

    <span class="n">splits</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_splits</span><span class="p">):</span>
        <span class="n">train_end</span> <span class="o">=</span> <span class="n">split_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n_splits</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">val_end</span> <span class="o">=</span> <span class="n">split_indices</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">val_end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorted_data</span><span class="p">)</span>

        <span class="n">train_indices</span> <span class="o">=</span> <span class="n">sorted_data</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="n">train_end</span><span class="p">]</span>
        <span class="n">val_indices</span> <span class="o">=</span> <span class="n">sorted_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">train_end</span><span class="p">:</span><span class="n">val_end</span><span class="p">]</span>

        <span class="n">splits</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">train_indices</span><span class="p">,</span> <span class="n">val_indices</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">splits</span>
</code></pre></div>
<h3 id="53-baseline-models">5.3 Baseline Models</h3>
<ul>
<li>
<p>Implement simple baseline models for comparison</p>
</li>
<li>
<p>Document baseline performance</p>
</li>
<li>
<p>Use baselines to validate the value of complex models</p>
</li>
</ul>
<h3 id="54-ab-testing">5.4 A/B Testing</h3>
<ul>
<li>
<p>Design robust A/B tests for model deployment</p>
</li>
<li>
<p>Define clear metrics for success</p>
</li>
<li>
<p>Calculate required sample size and duration</p>
</li>
<li>
<p>Document test results and statistical significance</p>
</li>
</ul>
<hr />
<h2 id="6-fairness-and-bias-mitigation">6. Fairness and Bias Mitigation</h2>
<h3 id="61-fairness-metrics">6.1 Fairness Metrics</h3>
<p>Evaluate models for fairness across sensitive attributes:</p>
<ul>
<li>
<p><strong>Demographic parity</strong>: Similar prediction rates across groups</p>
</li>
<li>
<p><strong>Equalized odds</strong>: Similar error rates across groups</p>
</li>
<li>
<p><strong>Equal opportunity</strong>: Similar true positive rates across groups</p>
</li>
<li>
<p><strong>Disparate impact</strong>: Ratio of positive prediction rates between groups</p>
</li>
</ul>
<h3 id="62-bias-detection">6.2 Bias Detection</h3>
<ul>
<li>
<p>Identify potential bias in training data</p>
</li>
<li>
<p>Monitor distributions of predictions across groups</p>
</li>
<li>
<p>Test for statistically significant differences</p>
</li>
<li>
<p>Document findings and mitigation steps</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># Example fairness evaluation</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">fairlearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">demographic_parity_difference</span>

<span class="k">def</span><span class="w"> </span><span class="nf">evaluate_fairness</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">sensitive_features</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate fairness metrics for a model.</span>

<span class="sd">    Args:</span>
<span class="sd">        y_true: Ground truth labels</span>
<span class="sd">        y_pred: Model predictions</span>
<span class="sd">        sensitive_features: DataFrame with sensitive attributes</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: Dictionary of fairness metrics</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fairness_metrics</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Compute demographic parity for each sensitive attribute</span>

    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">sensitive_features</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">dp_diff</span> <span class="o">=</span> <span class="n">demographic_parity_difference</span><span class="p">(</span>
            <span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">sensitive_features</span><span class="o">=</span><span class="n">sensitive_features</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">fairness_metrics</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;demographic_parity_diff_</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp_diff</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Demographic parity difference for </span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">dp_diff</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fairness_metrics</span>
</code></pre></div>
<h3 id="63-bias-mitigation-techniques">6.3 Bias Mitigation Techniques</h3>
<p>When bias is detected, consider:</p>
<ul>
<li>
<p><strong>Pre-processing</strong>: Modify training data to remove bias</p>
</li>
<li>
<p><strong>In-processing</strong>: Incorporate fairness constraints during training</p>
</li>
<li>
<p><strong>Post-processing</strong>: Adjust predictions to ensure fairness</p>
</li>
</ul>
<p>Document all bias mitigation approaches and their effects.</p>
<hr />
<h2 id="7-model-interpretability">7. Model Interpretability</h2>
<h3 id="71-interpretability-techniques">7.1 Interpretability Techniques</h3>
<p>Choose appropriate techniques based on model type:</p>
<ul>
<li>
<p><strong>Feature importance</strong>: SHAP values, permutation importance</p>
</li>
<li>
<p><strong>Partial dependence plots</strong>: For understanding feature relationships</p>
</li>
<li>
<p><strong>Local explanations</strong>: LIME for instance-level explanations</p>
</li>
<li>
<p><strong>Rule extraction</strong>: For distilling complex models into rules</p>
</li>
</ul>
<h3 id="72-explanation-requirements">7.2 Explanation Requirements</h3>
<p>Document the following for each model:</p>
<ul>
<li>
<p><strong>Global explanations</strong>: Overall model behavior</p>
</li>
<li>
<p><strong>Local explanations</strong>: How specific predictions are made</p>
</li>
<li>
<p><strong>Counterfactual explanations</strong>: What changes would alter predictions</p>
</li>
<li>
<p><strong>Limitations</strong>: What the model cannot explain</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># Example SHAP value calculation</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">shap</span>

<span class="k">def</span><span class="w"> </span><span class="nf">explain_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate SHAP explanations for a model.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: Trained model</span>
<span class="sd">        X: Feature matrix to explain</span>
<span class="sd">        feature_names: List of feature names</span>

<span class="sd">    Returns:</span>
<span class="sd">        shap_values: SHAP values for explanations</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create explainer</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;predict_proba&#39;</span><span class="p">):</span>
        <span class="n">explainer</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">KernelExplainer</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">,</span> <span class="n">shap</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">explainer</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">KernelExplainer</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">,</span> <span class="n">shap</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>

    <span class="c1"># Calculate SHAP values</span>

    <span class="n">shap_values</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="c1"># Generate summary plot</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">shap</span><span class="o">.</span><span class="n">summary_plot</span><span class="p">(</span><span class="n">shap_values</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="n">feature_names</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;shap_summary.png&#39;</span><span class="p">)</span>

    <span class="c1"># Log feature importance</span>

    <span class="k">if</span> <span class="n">feature_names</span><span class="p">:</span>
        <span class="n">importances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">shap_values</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">importance_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s1">&#39;feature&#39;</span><span class="p">:</span> <span class="n">feature_names</span><span class="p">,</span>
            <span class="s1">&#39;importance&#39;</span><span class="p">:</span> <span class="n">importances</span>
        <span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;importance&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Feature importance:</span><span class="se">\n</span><span class="si">{</span><span class="n">importance_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">shap_values</span>
</code></pre></div>
<hr />
<h2 id="8-model-versioning-and-reproducibility">8. Model Versioning and Reproducibility</h2>
<h3 id="81-versioning-strategy">8.1 Versioning Strategy</h3>
<ul>
<li>
<p>Version all model artifacts</p>
</li>
<li>
<p>Use semantic versioning (MAJOR.MINOR.PATCH)</p>
</li>
<li>
<p>Link models to training datasets and code versions</p>
</li>
<li>
<p>Store models in a model registry</p>
</li>
</ul>
<h3 id="82-reproducibility-requirements">8.2 Reproducibility Requirements</h3>
<p>Document the following to ensure reproducibility:</p>
<ul>
<li>
<p><strong>Environment</strong>: Dependencies and versions</p>
</li>
<li>
<p><strong>Data</strong>: Versioned datasets and preprocessing steps</p>
</li>
<li>
<p><strong>Parameters</strong>: Hyperparameters and random seeds</p>
</li>
<li>
<p><strong>Workflow</strong>: Steps to reproduce training</p>
</li>
</ul>
<h3 id="83-mlflow-integration">8.3 MLflow Integration</h3>
<p>Use MLflow to track experiments:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Example MLflow tracking</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">mlflow</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlflow.tracking</span><span class="w"> </span><span class="kn">import</span> <span class="n">MlflowClient</span>

<span class="k">def</span><span class="w"> </span><span class="nf">train_with_tracking</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Train a model with MLflow tracking.</span>

<span class="sd">    Args:</span>
<span class="sd">        model_name: Name for the model</span>
<span class="sd">        X_train/y_train: Training data</span>
<span class="sd">        X_test/y_test: Test data</span>
<span class="sd">        params: Model hyperparameters</span>

<span class="sd">    Returns:</span>
<span class="sd">        model: Trained model</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Start MLflow run</span>

    <span class="k">with</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">start_run</span><span class="p">(</span><span class="n">run_name</span><span class="o">=</span><span class="n">model_name</span><span class="p">)</span> <span class="k">as</span> <span class="n">run</span><span class="p">:</span>
        <span class="n">run_id</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Started MLflow run: </span><span class="si">{</span><span class="n">run_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Log parameters</span>

        <span class="n">mlflow</span><span class="o">.</span><span class="n">log_params</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

        <span class="c1"># Create and train model</span>

        <span class="n">model</span> <span class="o">=</span> <span class="n">create_model</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

        <span class="c1"># Evaluate model</span>

        <span class="n">metrics</span> <span class="o">=</span> <span class="n">evaluate_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
        <span class="n">mlflow</span><span class="o">.</span><span class="n">log_metrics</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>

        <span class="c1"># Log model</span>

        <span class="n">mlflow</span><span class="o">.</span><span class="n">sklearn</span><span class="o">.</span><span class="n">log_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;model&quot;</span><span class="p">)</span>

        <span class="c1"># Log feature names</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="s1">&#39;columns&#39;</span><span class="p">):</span>
            <span class="n">feature_names</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">mlflow</span><span class="o">.</span><span class="n">log_param</span><span class="p">(</span><span class="s2">&quot;feature_names&quot;</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Completed MLflow run: </span><span class="si">{</span><span class="n">run_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Metrics: </span><span class="si">{</span><span class="n">metrics</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">model</span>
</code></pre></div>
<hr />
<h2 id="9-model-deployment">9. Model Deployment</h2>
<h3 id="91-deployment-patterns">9.1 Deployment Patterns</h3>
<p>Select an appropriate deployment pattern:</p>
<ul>
<li>
<p><strong>Batch prediction</strong>: For non-time-sensitive applications</p>
</li>
<li>
<p><strong>Online API</strong>: For real-time inference</p>
</li>
<li>
<p><strong>Edge deployment</strong>: For client-side inference</p>
</li>
<li>
<p><strong>Hybrid approaches</strong>: Combination of patterns</p>
</li>
</ul>
<h3 id="92-deployment-requirements">9.2 Deployment Requirements</h3>
<p>Document the following for each deployment:</p>
<ul>
<li>
<p><strong>Performance requirements</strong>: Latency, throughput</p>
</li>
<li>
<p><strong>Resource requirements</strong>: Memory, CPU, GPU</p>
</li>
<li>
<p><strong>Scaling strategy</strong>: Horizontal vs. vertical</p>
</li>
<li>
<p><strong>Monitoring plan</strong>: What to monitor and alert on</p>
</li>
</ul>
<h3 id="93-containerization">9.3 Containerization</h3>
<p>Package models in containers for deployment:</p>
<div class="highlight"><pre><span></span><code><span class="c"># Example Dockerfile for model deployment</span>

<span class="k">FROM</span><span class="w"> </span><span class="s">python:3.9-slim</span>

<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>

<span class="c"># Install dependencies</span>

<span class="k">COPY</span><span class="w"> </span>requirements.txt<span class="w"> </span>.
<span class="k">RUN</span><span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--no-cache-dir<span class="w"> </span>-r<span class="w"> </span>requirements.txt

<span class="c"># Copy model and code</span>

<span class="k">COPY</span><span class="w"> </span>model/<span class="w"> </span>./model/
<span class="k">COPY</span><span class="w"> </span>api/<span class="w"> </span>./api/

<span class="c"># Set up environment</span>

<span class="k">ENV</span><span class="w"> </span><span class="nv">MODEL_PATH</span><span class="o">=</span>/app/model/recommendation_model.pkl
<span class="k">ENV</span><span class="w"> </span><span class="nv">LOG_LEVEL</span><span class="o">=</span>INFO

<span class="c"># Expose API port</span>

<span class="k">EXPOSE</span><span class="w"> </span><span class="s">8000</span>

<span class="c"># Run API server</span>

<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;uvicorn&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;api.main:app&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--host&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;0.0.0.0&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--port&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;8000&quot;</span><span class="p">]</span>
</code></pre></div>
<hr />
<h2 id="10-monitoring-and-maintenance">10. Monitoring and Maintenance</h2>
<h3 id="101-model-monitoring">10.1 Model Monitoring</h3>
<p>Monitor the following aspects:</p>
<ul>
<li>
<p><strong>Performance metrics</strong>: Accuracy, precision, etc.</p>
</li>
<li>
<p><strong>Data drift</strong>: Changes in input distributions</p>
</li>
<li>
<p><strong>Concept drift</strong>: Changes in relationship between inputs and outputs</p>
</li>
<li>
<p><strong>System metrics</strong>: Latency, throughput, errors</p>
</li>
</ul>
<h3 id="102-alerting">10.2 Alerting</h3>
<p>Set up alerts for:</p>
<ul>
<li>
<p><strong>Performance degradation</strong>: Drops below threshold</p>
</li>
<li>
<p><strong>Significant drift</strong>: Beyond acceptable limits</p>
</li>
<li>
<p><strong>Operational issues</strong>: Latency spikes, errors</p>
</li>
<li>
<p><strong>Bias emergence</strong>: Fairness metric changes</p>
</li>
</ul>
<h3 id="103-maintenance-schedule">10.3 Maintenance Schedule</h3>
<p>Define procedures for:</p>
<ul>
<li>
<p><strong>Regular retraining</strong>: Schedule and triggers</p>
</li>
<li>
<p><strong>Feature updates</strong>: Process for adding/removing features</p>
</li>
<li>
<p><strong>Architecture updates</strong>: Major model changes</p>
</li>
<li>
<p><strong>Retirement plan</strong>: When and how to retire models</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># Example data drift detection</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">ks_2samp</span>

<span class="k">def</span><span class="w"> </span><span class="nf">detect_data_drift</span><span class="p">(</span><span class="n">reference_data</span><span class="p">,</span> <span class="n">current_data</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Detect drift between reference and current data distributions.</span>

<span class="sd">    Args:</span>
<span class="sd">        reference_data: Baseline data (e.g., training data)</span>
<span class="sd">        current_data: Current production data</span>
<span class="sd">        threshold: p-value threshold for drift detection</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: Drift detection results</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">drift_results</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Check each feature for drift</span>

    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">reference_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">reference_data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="ow">in</span> <span class="s1">&#39;fc&#39;</span><span class="p">:</span>  <span class="c1"># Float/complex numeric</span>

            <span class="c1"># Use Kolmogorov-Smirnov test for numeric features</span>

            <span class="n">stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">ks_2samp</span><span class="p">(</span>
                <span class="n">reference_data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span>
                <span class="n">current_data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
            <span class="p">)</span>

            <span class="n">drift_detected</span> <span class="o">=</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">threshold</span>
            <span class="n">drift_results</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;drift_detected&#39;</span><span class="p">:</span> <span class="n">drift_detected</span><span class="p">,</span>
                <span class="s1">&#39;p_value&#39;</span><span class="p">:</span> <span class="n">p_value</span><span class="p">,</span>
                <span class="s1">&#39;statistic&#39;</span><span class="p">:</span> <span class="n">stat</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="n">drift_detected</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Drift detected in feature </span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">: &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;p-value=</span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, statistic=</span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

    <span class="k">return</span> <span class="n">drift_results</span>
</code></pre></div>
<hr />
<h2 id="11-ethics-and-responsible-ai">11. Ethics and Responsible AI</h2>
<h3 id="111-ethical-guidelines">11.1 Ethical Guidelines</h3>
<p>Follow these principles:</p>
<ul>
<li>
<p><strong>Transparency</strong>: Be open about how models work</p>
</li>
<li>
<p><strong>Fairness</strong>: Ensure fair treatment across groups</p>
</li>
<li>
<p><strong>Privacy</strong>: Protect user data and preferences</p>
</li>
<li>
<p><strong>Security</strong>: Protect models from attacks</p>
</li>
<li>
<p><strong>Accountability</strong>: Take responsibility for model impacts</p>
</li>
</ul>
<h3 id="112-impact-assessment">11.2 Impact Assessment</h3>
<p>For each model, document:</p>
<ul>
<li>
<p><strong>Intended use cases</strong>: What the model is designed for</p>
</li>
<li>
<p><strong>Limitations</strong>: What the model cannot do</p>
</li>
<li>
<p><strong>Potential misuses</strong>: How the model could be misused</p>
</li>
<li>
<p><strong>Mitigation strategies</strong>: How to prevent misuse</p>
</li>
</ul>
<h3 id="113-documentation-templates">11.3 Documentation Templates</h3>
<p>Use standardized templates for:</p>
<ul>
<li>
<p><strong>Model cards</strong>: Summary of model characteristics</p>
</li>
<li>
<p><strong>Datasheets</strong>: Documentation of datasets</p>
</li>
<li>
<p><strong>Impact assessments</strong>: Ethical and social impact</p>
</li>
</ul>
<p>Example model card structure:</p>
<div class="highlight"><pre><span></span><code># Model Card: User-Content Recommendation Model

## Model Details

* Name: RecSys v2.1

* Type: Matrix Factorization with Neural Features

* Date: April 2, 2025

* Version: 2.1.0

* Owners: Recommendation Team

## Intended Use

* Primary use: Personalize content recommendations

* Out-of-scope uses: Should not be used for critical decisions

## Training Data

* Source: User interaction history (Jan 2024 - Mar 2025)

* Size: 10M users, 1M content items, 500M interactions

* Preprocessing: Removed bots, normalized engagement signals

## Evaluation Results

* Offline metrics: NDCG@10: 0.42, MAP@10: 0.38

* A/B test results: +7.2% engagement, +3.5% retention

## Ethical Considerations

* Fairness: Evaluated across age groups, gender, geography

* Limitations: May underserve new users (cold start)

* Mitigations: Diversity injection, exploration component

## Quantitative Analysis

* Performance characteristics: 95% predictions &lt; 20ms

* Fairness metrics: Demographic parity diff &lt; 0.05 across groups
</code></pre></div>
<hr />
<h2 id="12-collaboration-between-data-scientists-and-engineers">12. Collaboration Between Data Scientists and Engineers</h2>
<h3 id="121-workflow-integration">12.1 Workflow Integration</h3>
<ul>
<li>
<p>Use shared repositories for model and pipeline code</p>
</li>
<li>
<p>Define clear interfaces between components</p>
</li>
<li>
<p>Document APIs for model serving</p>
</li>
<li>
<p>Establish review processes for ML artifacts</p>
</li>
</ul>
<h3 id="122-handoff-procedures">12.2 Handoff Procedures</h3>
<p>Document the following for engineering handoffs:</p>
<ul>
<li>
<p><strong>Model requirements</strong>: Resource needs, dependencies</p>
</li>
<li>
<p><strong>Expected behavior</strong>: Input/output specifications</p>
</li>
<li>
<p><strong>Performance characteristics</strong>: Latency, throughput</p>
</li>
<li>
<p><strong>Monitoring requirements</strong>: Metrics to track</p>
</li>
</ul>
<hr />
<p>By following these ML development guidelines, ThinkAlike ensures that our machine learning systems are robust, fair, explainable, and maintainable, while delivering maximum value to our users.</p>
<hr />
<p><strong>Document Details</strong></p>
<ul>
<li>
<p>Title: ML Development Guidelines</p>
</li>
<li>
<p>Type: Developer Guide</p>
</li>
<li>
<p>Version: 1.0.0</p>
</li>
<li>
<p>Last Updated: 2025-04-05</p>
</li>
</ul>
<hr />
<p>End of ML Development Guidelines</p>
<hr />
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
