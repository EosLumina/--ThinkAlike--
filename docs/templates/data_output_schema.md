# ThinkAlike: Standard Data Output Schema Specification

**Version:** 1.0
**Date:** March 26, 2025

---

## 1. Introduction

This document specifies the **standard JSON schema** intended for structuring reusable data outputs generated by various components within the ThinkAlike platform. This includes outputs from:

* Testing frameworks (unit, integration, E2E, performance, ethical, accessibility)
* Data validation routines (client-side or server-side)
* AI analysis modules (e.g., ethical compliance checks, performance metrics)
* Potentially diagnostic or monitoring tools

The purpose of this standardized schema is to:

* Ensure **consistency** in how results and data snippets are represented.
* Facilitate easier **parsing, processing, and aggregation** of outputs from different sources.
* Simplify the development of **UI components** designed to visualize these outputs (e.g., `DataDisplay`, Test Results Dashboards within the `Customizable UI Tests` feature).
* Promote clear **data exchange** and understanding between different system modules and development tools.
* Reinforce **data traceability** by providing standard fields for source and context.

Adherence to this schema, where applicable, allows for predictable data structures, simplifies integration, and supports the "UI as Validation Framework" by providing a common language for validation results.

---

## 2. Schema Definition (`data_output.json` Structure Example)

The following describes the fields and structure for a standard data output object. Implementations should populate the relevant fields based on the specific context and type of output being generated.

```json
{
  "outputId": {
    "type": "string",
    "description": "A unique identifier for this specific data output instance (e.g., generated UUID, composite ID like testRunId-testCaseId). Essential for tracking and referencing.",
    "required": true,
    "example": "evt_a7b3c9d1-e4f5-4a6b-8c7d-1e2f3a4b5c6d"
  },
  "timestamp": {
    "type": "string",
    "format": "date-time",
    "description": "ISO 8601 timestamp indicating precisely when this data output was generated.",
    "required": true,
    "example": "2025-03-26T14:30:00Z"
  },
  "sourceComponent": {
    "type": "string",
    "description": "Identifier of the specific component, module, function, test case, or process that generated this output. Provides origin context.",
    "required": true,
    "example": "TestEthicalBias.test_matching_diversity"
  },
  "workflowContext": {
    "type": "string",
    "description": "Identifier or name of the broader workflow, user action, or scenario this output is part of. Helps group related outputs.",
    "required": false,
    "example": "mode2_profile_discovery_load"
  },
  "dataType": {
    "type": "string",
    "description": "A category describing the nature or purpose of the primary data contained in the 'value' field. Used by consumers (like UI) to determine how to interpret/display the value.",
    "required": true,
    "examples": [
        "test_case_result", "validation_result", "performance_metric",
        "ethical_assessment", "accessibility_violation", "ai_inference",
        "data_snapshot", "configuration_value", "log_message"
        // Add more specific types as needed
    ]
  },
  "value": {
    "type": [ "string", "number", "boolean", "object", "array", "null" ],
    "description": "The core data payload of this output. The structure is flexible and depends heavily on the 'dataType'. It should contain the actual result, metric, finding, or data snippet.",
    "required": true,
    "examples": [
      // Example for dataType: "test_case_result"
      { "status": "fail", "assertion": "Expected email format", "actual": "invalid-email" },
      // Example for dataType: "performance_metric"
      { "metric": "ComponentRenderTime", "value": 45.6, "unit": "ms" },
      // Example for dataType: "ethical_assessment"
      { "principle": "BiasMitigation", "score": 0.92, "details": "Passed demographic parity check." },
      // Example for dataType: "accessibility_violation"
      { "ruleId": "color-contrast", "severity": "serious", "elementSelector": "#submit-button" }
    ]
  },
  "metadata": {
    "type": "object",
    "description": "Optional field containing supplementary context or metadata not part of the core value.",
    "properties": {
      "userId": { "type": "string", "description": "User ID context, if applicable and safe to include." },
      "sessionId": { "type": "string", "description": "Session ID context, if applicable." },
      "parametersUsed": { "type": "object", "description": "Key input parameters that led to this output." },
      "componentVersion": { "type": "string", "description": "Version of the sourceComponent." },
      "schemaVersion": { "type": "string", "description": "Version of the data schema this value relates to." }
      // Add other relevant metadata fields as needed
    },
    "required": false
  },
  "validation": {
    "type": "object",
    "description": "Information specifically about the validation status of the data *within* the 'value' field itself (distinct from a test case pass/fail).",
    "properties": {
      "status": {
        "type": "string",
        "enum": ["valid", "invalid", "warning", "not_validated"],
        "description": "Validation status of the 'value' content."
      },
      "message": {
        "type": "string",
        "description": "Specific validation message (e.g., 'Email format incorrect', 'Value exceeds maximum threshold')."
      },
      "ruleChecked": {
        "type": "string",
        "description": "Identifier of the validation rule or schema definition applied."
      }
    },
    "required": false
  },
  "ethicalCompliance": {
    // Reusing the structure defined for Test Reports for consistency
    "$ref": "test_report_schema.md#/definitions/ethicalComplianceResult", // Reference if using JSON Schema refs, or define inline
    "description": "Specific assessment related to ThinkAlike's ethical guidelines. Optional.",
    "required": false
    // Inline definition for clarity here:
    // "type": "object",
    // "properties": { ... as defined in test_report_schema ... }
  },
  "traceability": {
      "type": "object",
      "description": "Information supporting data lineage and traceability.",
      "properties": {
          "dataSources": {
              "type": "array",
              "items": { "type": "string" },
              "description": "List of IDs or names of primary data sources contributing to this output."
          },
          "transformationSteps": {
              "type": "array",
              "items": { "type": "string" },
              "description": "Brief descriptions of key transformations applied to arrive at this output."
          },
          "correlationId": {
              "type": "string",
              "description": "An ID linking this output to related events or outputs in a larger workflow."
          }
      },
      "required": false
  }
}
```

---

## 3. Usage Scenarios

* **Test Result Output:** An automated test case finishes. It generates an object following this schema where `dataType` is "test_case_result" and `value` contains `{ "status": "pass", "assertion": "User login successful" }`. The `validation` field might be null or `not_validated` if the test didn't specifically validate the output data format itself beyond the pass/fail assertion.

* **Performance Metric:** A performance monitor hook wraps a component render. It generates an output with `dataType`: "performance_metric", `value`: `{ "metric": "RenderDuration", "value": 15, "unit": "ms" }`, and `sourceComponent`: "UserProfileCard".

* **Ethical Check:** The CoreValuesValidator UI component analyzes user input. It might generate an output (or receive one from the backend Verification System) with `dataType`: "ethical_assessment", `value`: `{ "principle": "Civility", "score": 0.65, "details": "Detected potentially aggressive language." }`, `validation`: `{ "status": "warning" }`, and potentially details in `ethicalCompliance`.

---

## 4. Implementation Notes

* **Consistency:** While `value` is flexible, strive for consistent structures within the same `dataType`. For example, all outputs with `dataType`: "performance_metric" should likely have a `value` object with `metric`, `value`, and `unit` fields.

* **Granularity:** Decide on the appropriate level of granularity for outputs. Should one user action generate one output, or multiple outputs for different aspects (performance, validation, ethical)? This depends on the consuming system.

* **Context is Key:** Ensure `sourceComponent` and `workflowContext` provide enough context to understand where the output originated.

* **UI Integration:** Design UI components (DataDisplay, dashboards) to intelligently render different parts of this schema based on the `dataType` and the presence of optional fields like `validation` or `ethicalCompliance`.

---

## 5. Schema Location

This schema definition resides in `docs/templates/data_output_schema.md`.

Example JSON instances conforming to this schema could be placed in `docs/templates/examples/` or used within test fixtures.
