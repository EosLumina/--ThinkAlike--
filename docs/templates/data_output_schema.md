# Standard Data Output Schema Specification

---

## 1. Introduction

This document specifies the **standard JSON schema** for reusable data outputs generated by various components within ThinkAlike, particularly testing frameworks ([Testing Plan](../guides/developer_guides/testing_and_validation_plan.md)), validation routines, and AI analysis modules. This ensures consistency, facilitates processing/visualization by UI components ([DataDisplay Spec](../components/ui/data_display_spec.md)), and promotes clear data exchange.

This schema is often referenced or embedded within the [Standard Test Report Schema](./test_report_schema.md).

---

## 2. Schema Definition (`data_output.json` Structure Example)

```json
{
  "outputId": {
    "type": "string",
    "description": "Unique identifier for this specific data output instance (e.g., UUID, testRunId-testCaseId-outputIndex).",
    "required": true
  },
  "timestamp": {
    "type": "string",
    "format": "date-time",
    "description": "ISO 8601 timestamp: When this output was generated.",
    "required": true
  },
  "sourceComponent": {
    "type": "string",
    "description": "Identifier of the component, module, function, or test case generating this output.",
    "required": true,
    "example": "EthicalComplianceTest.check_data_minimization"
  },
  "workflowContext": {
    "type": "string",
    "description": "Identifier of the broader workflow this output belongs to.",
    "required": false,
    "example": "user_profile_update_validation"
  },
  "dataType": {
    "type": "string",
    "description": "Category describing the nature of the 'value' field.",
    "required": true,
    "examples": [
      "test_assertion_result",
      "validation_finding",
      "performance_metric",
      "ethical_assessment",
      "accessibility_violation",
      "ai_inference_result",
      "data_snapshot",
      "configuration_setting",
      "log_entry_detail"
    ]
  },
  "value": {
    "type": [ "string", "number", "boolean", "object", "array", "null" ],
    "description": "The core data payload. Structure depends on 'dataType'.",
    "required": true,
    "examples": [
      {
        "dataType": "validation_finding",
        "value": {
          "status": "error",
          "rule": "email_format",
          "field": "user_email",
          "message": "Invalid email address format."
        }
      },
      {
        "dataType": "performance_metric",
        "value": {
          "name": "DBQueryTime",
          "value": 75,
          "unit": "ms"
        }
      },
      {
        "dataType": "ethical_assessment",
        "value": {
          "guideline": "BiasMitigation",
          "status": "warning",
          "metric": "demographic_parity_diff",
          "value": 0.15
        }
      }
    ]
  },
  "metadata": {
    "type": "object",
    "description": "Optional supplementary context.",
    "properties": {
      "userId": {
        "type": "string",
        "description": "Associated User ID (if applicable)."
      },
      "sessionId": {
        "type": "string",
        "description": "Associated Session ID (if applicable)."
      },
      "inputParameters": {
        "type": "object",
        "description": "Key input parameters leading to this output."
      },
      "componentVersion": {
        "type": "string",
        "description": "Version of the sourceComponent."
      }
    },
    "required": false
  },
  "validation": {
    "type": "object",
    "properties": {
      "status": {
        "type": "string",
        "enum": ["valid", "invalid", "warning", "not_validated"],
        "description": "Status of the 'value' content."
      },
      "message": {
        "type": "string",
        "description": "Specific validation message."
      },
      "ruleChecked": {
        "type": "string",
        "description": "Validation rule/schema ID applied."
      }
    },
    "required": false
  },
  "ethicalCompliance": {
    "$ref": "#/definitions/ethicalComplianceResult",
    "description": "Ethical compliance assessment specific to this output.",
    "required": false
  },
  "traceability": {
    "type": "object",
    "properties": {
      "dataSources": {
        "type": "array",
        "items": {
          "type": "string"
        },
        "description": "IDs of primary data sources."
      },
      "transformationSteps": {
        "type": "array",
        "items": {
          "type": "string"
        },
        "description": "Key transformations applied."
      },
      "correlationId": {
        "type": "string",
        "description": "ID linking related outputs."
      }
    },
    "required": false
  }
},
"definitions": {
  "ethicalComplianceResult": {
    "type": "object",
    "description": "Standard structure for ethical compliance results.",
    "properties": {
      "overallScore": {
        "type": "number",
        "description": "Aggregated ethical alignment score (e.g., 0-100)."
      },
      "principleStatus": {
        "type": "object",
        "description": "Status against specific principles.",
        "additionalProperties": {
          "type": "string",
          "enum": ["ok", "warning", "violation"]
        }
      },
      "concerns": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "severity": {
              "type": "string",
              "enum": ["Low", "Medium", "High", "Critical"]
            },
            "description": {
              "type": "string"
            },
            "guidelineRef": {
              "type": "string",
              "description": "Reference to violated ethical guideline ID."
            }
          }
        }
      }
    }
  }
}

```

---

## 3. Usage Scenarios

* **Test Result Output:** An automated test case finishes. It generates an object following this schema where `dataType` is "test_assertion_result" and `value` contains `{ "status": "pass", "assertion": "User login successful" }`. The `validation` field might be null or `not_validated` if the test didn't specifically validate the output data format itself beyond the pass/fail assertion.

* **Performance Metric:** A performance monitor hook wraps a component render. It generates an output with `dataType`: "performance_metric", `value`: `{ "name": "RenderDuration", "value": 15, "unit": "ms" }`, and `sourceComponent`: "UserProfileCard".

* **Ethical Check:** The CoreValuesValidator UI component analyzes user input. It might generate an output (or receive one from the backend Verification System) with `dataType`: "ethical_assessment", `value`: `{ "guideline": "Civility", "status": "warning", "metric": "language_tone", "value": 0.65 }`, `validation`: `{ "status": "warning" }`, and potentially details in `ethicalCompliance`.

---

## 4. Implementation Notes

* **Consistency:** While `value` is flexible, strive for consistent structures within the same `dataType`. For example, all outputs with `dataType`: "performance_metric" should likely have a `value` object with `name`, `value`, and `unit` fields.

* **Granularity:** Decide on the appropriate level of granularity for outputs. Should one user action generate one output, or multiple outputs for different aspects (performance, validation, ethical)? This depends on the consuming system.

* **Context is Key:** Ensure `sourceComponent` and `workflowContext` provide enough context to understand where the output originated.

* **UI Integration:** Design UI components (DataDisplay, dashboards) to intelligently render different parts of this schema based on the `dataType` and the presence of optional fields like `validation` or `ethicalCompliance`.

---

## 5. Schema Location

This schema definition resides in `docs/templates/data_output_schema.md`.

---

**Document Details**

* Title: Standard Data Output Schema Specification

* Type: Technical Documentation

* Version: 1.0.0

* Last Updated: 2025-04-05

---

End of Standard Data Output Schema Specification

---

Example JSON instances conforming to this schema could be placed in `docs/templates/examples/` or used within test fixtures.
